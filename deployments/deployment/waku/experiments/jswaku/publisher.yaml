apiVersion: v1
kind: Pod
metadata:
  name: publisher
  namespace: zerotesting
  labels:
    app: zerotenkay-publisher
spec:
  restartPolicy: Never
  dnsConfig:
    searches:
      - zerotesting-publisher.zerotesting.svc.cluster.local
  volumes:
  - name: api-requester-config-volume
    configMap:
      name: api-requester-config
  containers:
    - name: publisher-container
      # image: pearsonwhite/pod-api-requester:1e161cdf41478000bea17f9332f3624e9aad0829
      image: pearsonwhite/pod-api-requester:130d06bc5feef7266d4ef8ab4375a28f5466e4cc
      imagePullPolicy: Always

      # command: [ "sleep", "infinity"]

      command:
        [
          "python",
          "/app/api_requester.py",
          "--mode",
          "server",
          "--config",
          "/mount/config.yaml",
        ]

      ports:
        - containerPort: 8645
        - containerPort: 8008
        - containerPort: 8080
      volumeMounts:
        - name: api-requester-config-volume
          mountPath: /mount
      resources:
        requests:
          memory: 64Mi
          cpu: 150m
        limits:
          memory: 600Mi
          cpu: 400m
